# QQQ LEAPS Mastery Bot (v2.5)

这是一个针对 Interactive Brokers (IBKR) 的高级全自动交易系统，实施 **Core-Satellite (核心-卫星)** 策略，专注于 **QQQ LEAPS (长期期权)** 交易。

## 🌟 核心设计理念

### Apple Aesthetics (苹果简约设计)
本系统采用全新的 **Apple 现代简约风格** 进行重构，旨在提供极致、直观、高端的交易体验。
*   **视觉语言**：采用毛玻璃特效 (Glassmorphism)、大圆角卡片布局及 SF Pro/Inter 现代字体。
*   **专业交互**：极致精简的色彩系统，配合柔和的呼吸状态指示，减少视觉疲劳，聚焦交易核心。
*   **术语规范**：全面采用标准金融与技术术语，从“战略终端”进化为“交易管理系统”。

---

## 🛠️ 核心功能

### 1. 自动化 LEAPS 交易策略
*   **低点入场机制**：实时监控 QQQ 价格，当跌幅达到设定阈值时自动触发入场。
*   **智能转仓 (Roll)**：在大跌行情中自动识别最优转仓契机，动态优化建仓成本。
*   **Delta 精准扫描**：工业级期权链扫描算法，根据目标 Delta 自动筛选合规 LEAPS 合约，内置 Delta 容错率。

### 2. 风险管理与执行
*   **流动性守卫 (Spread Guard)**：自动过滤价差过大的合约，确保交易成本受控。
*   **分段止盈策略 (Profit Tiers)**：支持用户自定义多段持有天数与对应的盈利比例要求。
*   **强制风控出口**：内置强制平仓天数阈值，自动管理 Theta 衰减。

### 3. 持久化与监控
*   **SQLite 核实引擎**：所有交易状态、系统设置、分段设置与运行日志均持久化至本地数据库。
*   **实时运行日志**：系统感知 API 连接状态，实时反馈交易信号、执行状态及系统警报。
*   **利润再投资枢纽**：支持将 LEAPS 实现利润自动定投至 QQQM，实现长期复利。

---

## 🚀 部署与使用 (Getting Started)

### 1. 环境准备
*   **API 接入**：需运行 IB Gateway 或 TWS 客户端 (Paper 端口 7497/4004)。
*   **运行环境**：推荐使用 Docker 部署，确保网络可访问 IB 端口。

### 2. 部署步骤
1.  **准备数据卷**: `docker volume create qqq-bot`
2.  **启动容器**: 使用 `docker-compose up -d` 启动。
3.  **系统初始化**: 访问 `http://<IP>:8000` 进入引导页面，设置管理员账号与密码。

### 3. 使用流程
1.  **登录控制面板**: 使用设置的账号登录。
2.  **调整参数**: 在“策略入场设置”和“风险管理设置”模块中输入您的目标参数。
3.  **监控运行**: 首页将实时展示账户资产信息、LEAPS 持仓状态以及系统运行日志。

---

## 📂 核心文件结构

*   **`main.py`**: 系统指挥中心，管理异步任务流。
*   **`strategy.py`**: 核心交易逻辑与合约扫描引擎。
*   **`persistence.py`**: 负责数据持久化与设置存取。
*   **`web/server.py`**: 基于 FastAPI 的管理端 API。
*   **`web/templates/`**: 采用 Apple 简约风格的 Web 模板。

---

> [!NOTE]
> **版本修订 (v2.5)**
> - **UI 重塑**：全面替换“硬核工业风”，采用极致简约的 Apple 设计系统。
> - **术语专业化**：移除了所有风格化词汇，采用标准金融与技术术语。
> - **逻辑增强**：优化了分段止盈与强制平仓天数的自动映射。
> - **稳定性提升**：修复了仪表盘日志面板在初始化时的显示占位符问题。

## ⚠️ 免责声明 (Disclaimer)
本软件仅供教育和研究使用。自动化交易存在极高风险。在使用实盘资金前，务必在 Paper Trading 环境中进行不少于 4 周的充分测试。使用风险由使用者自行承担。
